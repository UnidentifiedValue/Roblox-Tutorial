## Вступление:

Это вторая версия туториала, так как я подумал что можно сделать его лучше,
дополнив примерами, и лучше обьяснив темы. Также тут я буду писать не только от
себя, но и добавлять ссылки на хорошие источники в которых больше информации о
конкретной теме.

В прошлой версии я отталкивался от предположения что читатель имеет +- знания
как у меня, так что структура была сильно смешана, поэтому тут я буду стараться
вести повествование максимально линейно, не ссылаясь на неизвестные темы.

Ну и местами я использую английский сленг, так что be aware.

А ну и btw часть того что я сдесь написал является краткой сводкой/дополненем
тем из официальной документации движка, feel free to check it out:
[ссылка](https://create.roblox.com/docs/en-us/platform)

И еще, этот документ является больше теоретической сводкой, новичкам, при
желании и хорошем знании английского рекомендую параллельно пройти
[курс](https://create.roblox.com/docs/tutorials/fundamentals/coding-1/coding-fundamentals).

Последний коментарий, я не рекомендую использовать ИИ с целью написания кода,
однако очень рекомендую писать ему по поводу вопросов, возникших в процессе
написания или обдумывания кода.

### Расшифровка условностей:

- **...** - Один неопределенный обьект или несколько (кстати в самом языке
  также)
- ****...** - Сложная тема, feel free to do additional research
- **x, y** - Один неопределенный обьект
- **?** - Один неопределенный тип
- **ВАЖНО:** - Важная пометка (вау, неужели)

## Существующие типы данных:

- **nil** - обозначает ничто. Не равен ни одному другому типу.
- **boolean** - может быть только true или false
- **number** - число
  > а если еще точнее - хранит в себе
  > `double-precision floating-point number
  > 64-bit`. Любое число не входящее
  > в приделы приравнивается значение inf или -inf
- **string** - набор букв,таких как буквы, цифры и спец символы
  > то что это набор а не единая структура тоже важно для общего понимания
- **enum** - кастомные типы данных, заданные движком
  > в luau нельзя создать собственный enum, а все существующие хранятся в
  > стандартном API
- **tables** - структуры данных, вида `{[index] = value}`. Есть два подвида
  tables:
  - **arrays** - индексами являются ТОЛЬКО цифры, все элементы идут непрерывно,
    для управления используется библиотека `table`.

  - **dictionaries** - индексами являются любые типы данных, элементы
    добавляются через `t[x] = y`, а удаляются через `t[x] = nil`.
    > ВАЖНО: нельзя определить количество существующих индексов без перебора.

## Особенности языка:

- ### **Комментарии**:

  Однострочные комментарии:

  ```lua
  -- ...
  ```

  Многострочные комментарии:

  ```
  --[[
      ...
  ]]
  ```

- ### **Переменные**:
  Для обьявления переменной, вне зависимости от её типа используется `local`.

  Для присвоения значение, используйте `=`, например:
  ```lua
  local a = x
  ```

- ### ****Области видимости**:

  Я думаю что для полного понимания этой темы нужна визуализация, так что:
  [вот ссылка](https://create.roblox.com/docs/luau/scope).

  Если кратко - весь код можно поделить на блоки, в которых существуют какие-то
  переменные и выполняются какие-то функции. Эти переменные и функции видны
  только внутри этого блока и других вложенных в него блоков. Переменные и
  функции внешнего блока видны во всех внутренних, но не наоборот. Один такой
  блок и называют областью видимости.

  Область видимости можно явно задать используя структуру
  ```lua
  do 
    ...
  end
  ```
  Пример:

  ```lua
  local outsideVar = 10

  do
    local insideVar = 5
    print(outsideVar, insideVar) -- 10, 5
  end

  print(outsideVar) -- 10
  print(insideVar) -- nil (так как insideVar здесь не виден)
  ```

  > *(В целом, такая структура существует в любом другом языке, и именно она
  > позволяет компилятору эффективно освобождать ресурсы у уже неиспользуемых
  > переменных (garbage collection))

- **Операторы**: Тут я честно просто дам ссылку, тк там хорошо расписанны
  примеры: https://create.roblox.com/docs/luau/operators. Если кратко существуют
  операторы:

  - **Логические:**

    `and, or, not`,
  - **Относительные:**

    `~=, ==, <, >, <=, >=`,
  - **Арифметические:**

    `+, -, *, /, //, ^, %`,
  - **Особые:**

    `.., #`
  - **Сложные:**

    `+=, -=, *=, /=, //=, %=, ^=, ..=`.

  Большинство операторов понятно каждому, но я уточню насчет 3х:
  - `^` - возведение в степень
  - `..` - concatenation / сложение строк
    > ВАЖНО: не тоже самое что +, он работает только для цифр, в то время как ..
    > работает только для строк,
  - `\#` - определяет количество элементов ТОЛЬКО в array

- ### Структуры управления:
  Существует несколько структур, но что важно - каждая из них должна
  заканчиваться end и внутри каждая структура содержит область видимости.

  - `if then else` - проверка условия, если условие = `true`, то выполняется
    фрагмент после `then`, иначе - после `else`. `else` не является
    обязательным, также можно комбинировать `else` и `if` для создания более
    сложных условий.
    > ВАЖНО: выполнение проверок идет строго сверху вниз

    Примеры:
    ```lua
    if a == b then
      a += 1
    elseif a <= 3 then
      a %= 2
    else
      b *= 2
    end
    ```

    Простые условия можно сжимать в одну строчку, однако не рекомендованно
    сжимать сложные, так как это сильно снижает читабельность кода

    Рекомендованно:
    ```lua
    if a > 0 then a -= 1 end
    ```

    Не рекомендованно:
    ```lua
    if a > 0 then print(""); a -= 1; b += a end
    ```

  - `while` loop - циклично проверяет условие и если оно верно - выполняется
    фрагмент после do
    > ВАЖНО:
    >
    > - первая проверка происходит ПЕРЕД выполнением фрагмента кода
    > - см [Сноску о циклах](/index.md/#сноска-о-циклах)

    Пример:
    ```lua
    while a ~= 0 do
      a += 1
    end
    ```

  - `repeat until` loop - циклично проверяет условие, и если оно = true, то
    прерывает цикл
    > ВАЖНО:
    >
    > - первая проверка происходит ПОСЛЕ выполнением фрагмента кода
    > - см [Сноску о циклах](/index.md/#сноска-о-циклах)

    Пример:
    ```lua
    repeat
      a += 1
    until a > 0
    ```

  - `for` loop - повторяет фрагмент после do n раз / производит перебор
    существующих элементов в array. (В примерах я использую i, v тк это
    общепринятые сокращения index и value, но в собственном коде важно называть
    каждую переменную понятно, чтобы было понятно зачем она нужна без глубокого
    анализа кода. Также, если какая либо из этих переменных не используется, то
    следует вместо её имени писать _)

    Повторение n раз:
    > (s = начальное значение, n+s = конечное значение, inc = сколько
    > прибавляется к i за проход цикла(необязательный параметр, по дефолту 1))

    ```lua
    for i = s, n+s, inc do
      ...
    end
    ```

    Перебор элементов:
    > (В ранних версиях языка после in добавлялись pairs()/ipairs(), но в
    > современном luau компилятор сам определяет каким методом делать перебор)

    ```lua
    local t = {}
    for i, v in t do
      ...
    end
    ```

    ```lua
    for i, v in {...} do
      ...
    end
    ```

  #### Сноска о циклах:
  Бесконечные циклы ДОЛЖНЫ иметь в себе task.wait(n) Обьяснение - если
  бесконечный цикл не имеет в себе задержки по времени, то компилятор стремится
  выполнить код сразу, что ведет к остановке обработки всего кода ради этого
  цикла, который никогда не завершится. В случае допущение подобной ошибки и
  запуска студии, она сначала пролагает с минуту, а потом крашнется / экстренно
  остановит выполнение кода

  #### Ключевые слова:
  - `continue` - пропускает текущую итерацию цикла
  - `break` - прерывает цикл

- ### **Функции
  Функция - это именованный блок кода, который можно вызвать из другого места
  программы. При вызове функции в неё можно передать данные (аргументы), которые
  она будет использовать для своей работы. Функция может вернуть результат своей
  работы обратно в то место, откуда её вызвали, используя ключевое слово return.
  Для обьявления функции необходимо использовать ключевое слово `function`.

  Примеры:
  - Способы задания функций:
    ```lua
    local function returnSum(firstNum, secondNum)
      return firstNum + secondNum
    end
    ```
    ```lua
    local doubleIt = function(n) return n * 2 end
    ```
    ```lua
    local funcTable = {
      ["substractOne"] = function(n)
        return n - 1
      end
    }
    ```

  - Способы вызова функций
    ```lua
    returnSum(5, 3) -- Компилятор просто выполнит вычисление
    ```
    ```lua
    print(doubleIt(5)) -- Будет выведенн результат умножения на 2, тоесть 10
    ```
    ```lua
    local sum = funcTable["substractOne"](25) -- Значению sum будет присвоен результат выполнения функции, тоесть 24
    ```

  > В теме про `connections` будет приведен еще способ задания функции и в теме
  > про ООП будет раскрыта еще информация о них, но для начала этой информации
  > достаточно

- ### **Задание типов:
  Последняя, но не менее важная тема этого раздела, это явное задание типов. В
  случаях, когда компилятор не может сам предсказать какой тип будет у
  переменной, задавание его вручную часто необходимо для работы автодополнения
  методов и аттрибутов обьектов.

  Для присвоения какого-то типа переменной используется `:`, для переопределения
  типа - `::`.

  Пример:
  ```lua
  local a : number = x
  local b = a :: string
  ```

  Для создания своего собственного типа, используется ключевое слово type. Тип
  задается как dictionary, но с явным определением типов у индексов.

  Примеры:
  ```lua
  type Vector2 = {x : number, y : number}
  ```

  ```lua
  type CustomType = {
    whatHappened : string, 
    valid : boolean
  }
  ```

  Поскольку тема достаточно обширна, вот ссылка на официальную документацию про
  typechecking, рекомендую почитать (опять же при достаточном знании
  английского): [ссылка](https://luau.org/typecheck).

  > ВАЖНО: Не путать с классами, типы никак не влияют на работу кода, а нужны
  > только для работы автозаполнения и удобства разработчика.

---

Итак, небольшое лирическое отступление, на этом заканчиваются основы языка, и
начинается углубление в API Roblox Studio. Несмотря на то что еще немного про
язык будет раскрыто чуть позже, этих знаний достаточно для начала работы с
чистым lua (даже не смотря на небольшие различия в языках), например с движком
love2d.

Перед продолжением рекомендую попробовать самому применить все полученные
знания, если вы этого еще не сделали, тк практика - единственный способ
действительно понять тему :) Ранее я уже кидал ссылку на туториал, описывающий
как создать первый place и первый скрипт, но, если что - я приведу очень простой
пример как это сделать, если не хотите следовать туториалу, а хотите все сделать
самостоятельно.

1. Установите Roblox Studio, например отсюда:
   [ссылка](https://create.roblox.com/docs/en-us/experiences)
2. Запустите и нажмите New Experience
3. В explorer найдите ServerScriptService и нажав на + справа найдите и нажмите
   на Script
4. Откройте новый script и напишите код, который хотите
5. На F5 Можно запустить place, и на shift+F5 остановить, все сообщения
   (например результаты print) будут выводится в output

Если возникли какие то проблемы или вопросы, посмотрите здесь:
[ссылка](https://create.roblox.com/docs/tutorials/fundamentals/coding-1/create-a-script),
а также можете загуглить или спросить у ИИ как создать новый плейс в Roblox
Studio и добавить в него первый скрипт.

---